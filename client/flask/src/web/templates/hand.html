<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/hand.css') }}">
  <script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
  <script type="text/javascript" charset="utf-8">
      var socket;

      const Http = new XMLHttpRequest();
      const host='http://localhost:8888/';


      $(document).ready(function(){
         socket = io.connect("http://localhost:8888/");

          socket.on('played', function() {
              location.reload();
          });
      });
      function play_a_card(card_index,player) {
        if(Http) {
          Http.onreadystatechange = function() {
                if (Http.readyState == XMLHttpRequest.DONE) {
                    var jsonResponse = Http.response;
                    if(jsonResponse["result"]){
                      socket.emit('play', card_index,player)
                    }
                }
            }
            Http.responseType = 'json';
            Http.open('POST',  host+"is_play_allowed/"+player, true);
            Http.setRequestHeader("Content-Type", "application/json");
            var data = JSON.stringify({"card": card_index});
            Http.send(data);
        }
      }




  </script>

</head>


<body>


<div class="hand">
  {%for i in range(len_card)%}
  <div class="card">
        <img src="{{ url_for('static', filename='card_game/'+Cards[i]+'.png') }}" align="left" alt="{{card}}" style="width:100%;height:100%" onclick="play_a_card({{i}},{{player}});">
  </div>
  {% endfor %}
</div>

{%for i in range(len_trick)%}
  {% if not( trick[i] == "") %}
  <div class="{{"trick" + trick_str[i]}}">

    <div class="card">
          <img src="{{ url_for('static', filename='card_game/'+trick[i]+'.png') }}" align="left" alt="{{trick[i]}}" style="width:100%;height:100%">
    </div>
  </div>
  {% endif %}
{% endfor %}

<!-- <button type="button" onclick="is_play_allowed(0,{{player}});">Test </button> -->

</body>
</html>
